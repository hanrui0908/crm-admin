<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用户管理</title>
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.min.css">
    <link href="../../css/bootstrap-theme.css" rel="stylesheet">
    <link href="../../bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="../../bootstraptable/bootstrap-table.css">
    <script src="../../js/jquery.js"></script>
    <script src="../../js/public.js"></script>
    <script src="../../js/bootstrap.js"></script>
    <script src="../../bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.js" ></script>
    <script src="../../bootstrap-datetimepicker-master/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script src="../../bootstraptable/bootstrap-table.js"></script>
    <script src="../../bootstraptable/bootstrap-table-zh-CN.js"></script>
</head>
<body>
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">当前位置>用户管理>学生用户列表</h3>
    </div>
    <div class="panel-body">
        <div class="row search_Div">
            <form class="form-inline">
                <div class="form-group col-xs-1">
                    <label>姓名：</label>
                    <input type="text" id="name" class="form-control">
                </div>
                <div class="form-group col-xs-1">
                    <label>状态：</label>
                    <select id="type" class="form-control">
                        <option value="0">全部</option>
                        <option value="1">启用</option>
                        <option value="2">停用</option>
                    </select>
                </div>
                <!--<div class="form-group col-xs-2">
                    <label>真实姓名：</label>
                    <input type="text" id="real_name" class="form-control">
                </div>-->
                <div class="form-group col-xs-1">
                    <label>用户昵称：</label>
                    <input id="nick_name" type="text" class="form-control" />
                </div>
                <div class="form-group col-xs-2">
                    <label>注册时间：</label>
                    <input id="b_create_time" type="text" class="form-control datetime">
                </div>
                <div class="form-group col-xs-2">
                    <label>至：</label>
                    <input id="e_create_time" type="text" class="form-control datetime">
                </div>
                <div class="form-group col-xs-2 col-md-offset-1" style="padding: 10px 0;">
                    <button type="button" class="btn btn-primary" id="submitBtn" onclick="search_user()">查询</button>
                </div>
            </form>
        </div>
        <br><br>
        <table class="table" id="table">
        </table>
    </div>
</div>
</body>
</html>
<script>
    $('.datetime').datetimepicker({
        language:  'zh-CN',
        format: 'yyyy-mm-dd',
        minView: "month", //选择日期后，不会再跳转去选择时分秒
        autoclose:true //选择日期后自动关闭
    });
    function search_user() {
        $('#table').bootstrapTable({
            method: 'get',
            striped: true,
            cache: false,
            pagination: true,
            sortable: false,
            sortOrder: "asc ",
            pageSize: 10,
            pageList: [10, 20, 50],
            url: 'http://192.168.0.170:15000/yc-crm/user/search',
            queryParams: setParams,
            sidePagination: "server",
            search: false,
            strictSearch: false,
            idField: "id ",
            columns: [
                {
                    width: 20,
                    field: 'name',
                    title: '姓名',
                    align: 'center'
                },
                {
                    width: 20,
                    field: 'gender',
                    title: '姓名',
                    align: 'center'
                },
                {
                    width: 20,
                    field: 'nickname',
                    title: '昵称',
                    align: 'center',
                },
                {
                    width: 20,
                    field: 'realname',
                    title: '真实姓名',
                    align: 'center',
                },
                {
                    width: 20,
                    field: 'createtime',
                    title: '注册时间',
                    align: 'center',
                    formatter: function (value) {
                        return value.substring(0,10);
                    }
                },
                {
                    width: 20,
                    field: 'type',
                    title: '状态',
                    align: 'center',
                    formatter: function (value) {
                        return value == 0 ? '启用' : '停用';
                    }
                },
                {
                    width: 50,
                    field: '',
                    title: '基本操作',
                    align: 'center',
                    formatter: function (value, row, index) {
                        console.log(row.id)
                        var info = "<a onclick='jump_to_per_user(\""+row.id+"\",0)'>详情&nbsp;</a>>";
                        var modify = "<a onclick='jump_to_per_user(\""+row.id+"\",1)'>修改&nbsp;</a>";
                        return info + modify;
                    }
                }
            ],
            pagination: true
        });
        $('#table').bootstrapTable('refresh');
    }
    function setParams(arg) {

        var param = '{';
        var name = $('#name').val();
        if (name != null && name != undefined && name != '') {
            param += '"name":"' + name + '",';
        }
        var nickname = $('#nickname').val();
        if (nickname != null && nickname != undefined && nickname != '') {
            param += '"nickname":"' + nickname + '",';
        }
        var realname = $('#real_name').val();
        if (realname != null && realname != undefined && realname != '') {
            param += '"real_name":"' + realname + '",';
        }
        var type = $('#type').val();
        if (type != null && type != undefined && type != '') {
            param += '"usertype":"' + type + '",';
        }

        var b_create_time = $('#b_create_time').val();
        if (b_create_time != null && b_create_time != undefined && b_create_time != '') {
            param += '"bctime":"' + b_create_time + '",';
        }
        var e_create_time = $('#e_create_time').val();
        if (e_create_time != null && e_create_time != undefined && e_create_time != '') {
            param += '"ectime":"' + e_create_time + '",';
        }
        param += '"plat":"0"';
        param += '}';
        arg.param = param;
        return arg;
    }
    function jump_to_per_user(id,arg){
        if (id != undefined || id != '' || id != null) {
            if (arg == 0) {
                window.location.href = "user_info.html?id='"+id+"'";
            }
            if (arg == 1) {
                window.location.href = "user_edit.html?id='"+id+"'";
            }
        }
    }
</script>