<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../css/easyui-themes.css">
    <link rel="stylesheet" type="text/css" href="../../css/yc.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/icon.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/layout-1.css"/>
    <script src="../../js/jquery.js"></script>
    <script src="../../js/jquery.easyui.min.js"></script>
    <script src="../../ueditor/ueditor.config.js"></script>
    <script src="../../ueditor/ueditor.all.js"></script>
    <script src="../../ueditor/ueditor.parse.js"></script>
    <script src="../../ueditor/lang/zh-cn/zh-cn.js"></script>
    <script src="../../ueditor/kityformula-plugin/addKityFormulaDialog.js"></script>
    <script src="../../ueditor/kityformula-plugin/getKfContent.js"></script>
    <script src="../../ueditor/kityformula-plugin/defaultFilterFix.js"></script>
    <script src="../../js/public.js"></script>
    <script>
        function  load_years() {
            var obj = {};
            obj.param = '{}';
            $.ajax({
                url: "http://192.168.0.170:15000/yc-crm/year/search",
                type: "post",
                cache: false,
                async: false,
                dataType: "json",
                data:obj,
                success: function (msg) {
                    console.log(msg);
                    if (msg.status == 0) {
                        var data=[];
                        var temp={}
                        temp.year=msg.result.result[0].create_time.substring(0,4);
                        data.push(temp);
                        $('#year').combobox({
                            valueField:'create_time',
                            textField:'create_time',
                            data: data,
                            panelHeight: 'auto',
                            onLoadSuccess: function () {
                                var val = $(this).combobox("getData");
                                for (var item in val[0]) {
                                    if (item == "year") {
                                        $(this).combobox("select", val[0][item]);
                                    }
                                }
                            }
                        });
                    }
                }
            });
        }
        $(function () {
            load_years();
        })
    </script>
    <style>
        .btn_121_addBtn{
            border:1px solid #D3D3D3;
            height: 30px;
            line-height: 30px;
            text-align: center;
            display: inline-block;
            padding: 0 10px;
        }
        .xx_121_content{
            border:1px solid #D3D3D3;
            min-height: 30px;
            font-size: 14px;
            line-height: 25px;
            word-break: break-all;
            work-wrap: break-word;
        }
        .xx_121_content p{
            font-size: 16px;
            line-height: 25px;
        }
        .subjectForm>table{
            display: none;
        }
        .subjectForm>table#sxdxOrzzdx{
            display: inline-table;
        }
        .edui-default .edui-editor {
            border: none;
            border-radius: 0;
        }
        .answerInput{
            line-height: 20px;
            border: 1px solid #d3d3d3;
        }
    </style>
</head>
<body>
<div class="easyui-layout" data-options="fit:true" style="display: ;">
    <div class="easyui-panel" title="当前位置：题库管理 > 基础题库 > 新建" data-options="fit:true">
        <div style="padding:10px 60px 20px 60px">
            <form id="ff" method="post">

                <table cellpadding="5" border="0" width="1000">
                    <tr>
                        <td align="right" width="20%">科目：</td>
                        <td width="30%">
                            <select class="easyui-combobox" id="subjectName" style="width: 200px;" data-options="editable:false, panelHeight:'auto'">
                                <option value="1">数学</option>
                                <option value="2">政治</option>
                                <option value="3">英语</option>
                            </select>
                        </td>
                        <td align="right" width="20%">题目来源：</td>
                        <td width="30%"><input class="easyui-textbox" style="width: 200px;" id="subjectForm" type="text" name="name" data-options="required:true" placeholder="请输入题目的来源"></input></td>

                    </tr>
                    <tr>
                        <td align="right">星级：</td>
                        <td>
                            <input class="easyui-textbox" type="text" id="stars"/>
                        </td>
                        <td align="right">状态：</td>
                        <td>
                            <select class="easyui-combobox" id="statu" style="width: 200px;" data-options="editable:false, panelHeight:'auto'">
                                <option value="1">启用</option>
                                <option value="2">停用</option>
                            </select>
                        </td>

                    </tr>
                    <tr>
                        <td align="right">题目类型：</td>
                        <td>
                            <select class="easyui-combobox" id="subjectType" style="width: 200px;"  data-options="editable:false, valueField:'id', textField:'text', panelHeight:'auto'">
                                <option value="1">单选题</option>
                                <option value="2">填空题</option>
                                <option value="3">解答题</option>
                            </select>
                        </td>
                        <td align="right">年份：</td>
                        <td>
                            <select class="easyui-combobox" id="year" style="width: 200px;"  data-options="editable:false,panelHeight:'auto'">
                            </select>
                        </td>

                    </tr>
                    <tr>
                        <td align="right">题干：</td>
                        <td colspan="3">
                            <div class="xx_121_content" style="width: 700px;"><script id="editor" style="height: 200px; width: 700px;" type="text/plain"></script></div>
                        </td>

                    </tr>
                </table>
                <div class="subjectForm">
                    <table id="sxdxOrzzdx" cellpadding="5" border="0" width="1000"><!--数学单选-->
                        <tr>
                            <td align="right" width="20%">选项：</td>
                            <td width="80%"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <table id="sxdxcontents" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="opentAll">
                                    <tr>
                                        <td align="right">A：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">B：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">C：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">D：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addOption">添加选项</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">答案：</td>
                            <td>
                                <input id="sxanswer" class="answerInput" onkeyup="this.value=this.value.toUpperCase()" maxlength="1" />
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td class="sxdxjx">
                                <div style="width:700px;" class="xx_121_content"></div>
                            </td>
                        </tr>
                    </table>

                    <table id="sxtk" border="0" width="1000"><!--数学填空-->
                        <tr>
                            <td align="right" width="20%">答案：</td>
                            <td>
                                <div style="width:700px;" class="xx_121_content answer"></div>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td class="sxtkjx">
                                <div style="width:700px;" class="xx_121_content analysis"></div>
                            </td>
                        </tr>

                    </table>
                    <table id="sxjd" border="0" width="1000"><!--数学解答题-->
                        <tr>
                            <td align="right" width="20%">解析：</td>
                            <td width="80%">
                                <div style="width:700px;" class="xx_121_content analysis"></div>
                            </td>
                        </tr>

                    </table>
                    <table id="zzdx" border="0" width="1000"><!--政治多选-->
                        <tr>
                            <td align="right" width="20%">选项：</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <table id="zzdxcontents" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="opentAll">
                                    <tr>
                                        <td align="right">A：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">B：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">C：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td align="right">D：</td>
                                        <td><div class="xx_121_content option"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addOption">添加选项</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">答案：</td>
                            <td>
                                <input id="zzdxanswer"class="answerInput" onkeyup="this.value=this.value.toUpperCase()" />
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td class="zzany">
                                <div style="width:700px;" class="xx_121_content"></div>
                            </td>
                        </tr>
                    </table>
                    <table id="zzcl" border="0" width="1000"><!--政治材料题目-->
                        <tr>
                            <td align="right" width="20%">问题：</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <table  id= "zzclxx" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="opentAll">
                                    <tr>
                                        <td align="right">（1）：</td>
                                        <td><div class="xx_121_content question"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addPolQuestion">添加问题</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">答案：</td>
                            <td>
                                <table id="zzcldn" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="opentAll">
                                    <tr>
                                        <td align="right">（1）：</td>
                                        <td><div class="xx_121_content answer"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addPolOption">添加答案</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td class="zzany">
                                <div style="width:700px;" class="xx_121_content" id="analysis"></div>
                            </td>
                        </tr>
                    </table>
                    <table id="yywx" border="0" width="1000"><!--英语完型-->
                        <tr>
                            <td align="right" width="20%">问题：</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <table  id="yywxwt0" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="answerAll">
                                    <tr class="yywxwt0">
                                        <td align="right" width="10%">（1）：</td>
                                        <td class="yywxwt1">
                                            <table class="yywxwt2" border="0" cellspacing="" cellpadding="5" width="100%">
                                                <tbody class="opentAll">
                                                <tr>
                                                    <td align="right" width="10%">A：</td>
                                                    <td><div class="xx_121_content option"></div></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>
                                                        <a href="javascript:void(0)" class="btn_121_addBtn addEnglishOption">添加选项</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="right">答案：</td>
                                                    <td><input class="answerInput" onkeyup="this.value=this.value.toUpperCase()" maxlength="1" /></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addAnswerGroup">添加问题组</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td>
                                <table class="yywxjx" border="0" cellpadding="5" width="100%">
                                <tbody class="analysistr">
                                <tr>
                                    <td width="10%" align="right">
                                        （1）：
                                    </td>
                                    <td>
                                        <div style="width:700px;" class="xx_121_content analysis"></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td><a href="javascript:void(0)" class="btn_121_addBtn addAnalysis">添加解析</a></td>
                                </tr>
                                </tbody>
                            </table>
                            </td>
                        </tr>
                    </table>
                    <table id="yyyd" border="0" width="1000"><!--英语阅读-->
                        <tr>
                            <td align="right" width="20%">问题：</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <table class="yyyd_out" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="readAll">
                                    <tr>
                                        <td align="right" width="10%">（1）：</td>
                                        <td class="yyyd_xx_outer"><div class="xx_121_content question"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <table  border="0" cellspacing="" cellpadding="5" width="100%">
                                                <tbody class="opentAll">
                                                <tr>
                                                    <td align="right" width="10%">A：</td>
                                                    <td class="yyyd_xx_inner"><div class="xx_121_content option"></div></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>
                                                        <a href="javascript:void(0)" class="btn_121_addBtn addEnglishOptiony">添加选项</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="right">答案：</td>
                                                    <td class="yyyd_answer"><input class="answerInput" onkeyup="this.value=this.value.toUpperCase()" maxlength="1" /></td>
                                                </tr>
                                                <tr>
                                                    <td align="right">解析：</td>
                                                    <td><div class="xx_121_content analysis"></div></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <a href="javascript:void(0)" class="btn_121_addBtn addReadGroup">添加问题</a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table id="yyqxw" border="0" width="1000"><!--英语7选5-->
                        <tr>
                            <td align="right" width="20%">答案：</td>
                            <td>
                                <table id="yy_7_xx" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="answerAll">
                                    <tr>
                                        <td align="right" width="10%">（1）：</td>
                                        <td width="90%"><div class="xx_121_content answer"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnswer">添加答案</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td>
                                <table   id="yy_7_jx" border="0" cellpadding="5" width="100%">
                                    <tbody class="analysistr">
                                    <tr>
                                        <td width="10%" align="right">
                                            （1）：
                                        </td>
                                        <td>
                                            <div style="width:700px;" class="xx_121_content analysis"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnalysis">添加解析</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table id="yyfy" border="0" width="1000"><!--英语翻译-->
                        <tr>
                            <td align="right" width="20%">答案：</td>
                            <td>
                                <table id= "yyfy_xx" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="answerAll">
                                    <tr>
                                        <td align="right" width="10%">（1）：</td>
                                        <td width="90%"><div class="xx_121_content answer"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnswer">添加答案</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td>
                                <table id="yyfy_jx" border="0" cellpadding="5" width="100%">
                                    <tbody class="analysistr">
                                    <tr>
                                        <td width="10%" align="right">
                                            （1）：
                                        </td>
                                        <td>
                                            <div style="width:700px;" class="xx_121_content analysis"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnalysis">添加解析</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table id="yypx" border="0" width="1000"><!--英语排序-->
                        <tr>
                            <td align="right" width="20%">答案：</td>
                            <td>
                                <table id="yypx_xx" border="0" cellspacing="" cellpadding="5" width="100%">
                                    <tbody class="answerAll">
                                    <tr>
                                        <td align="right" width="10%">（1）：</td>
                                        <td width="90%"><div class="xx_121_content answer"></div></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnswer">添加答案</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">解析：</td>
                            <td>
                                <table id="yypx_jx" border="0" cellpadding="5" width="100%">
                                    <tbody class="analysistr">
                                    <tr>
                                        <td width="10%" align="right">
                                            （1）：
                                        </td>
                                        <td>
                                            <div style="width:700px;" class="xx_121_content analysis"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><a href="javascript:void(0)" class="btn_121_addBtn addAnalysis">添加解析</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table id="yyzw" border="0" width="1000"><!--英语作文-->
                        <tr>
                            <td align="right" width="20%">范文：</td>
                            <td width="80%"><div class="xx_121_content composition"></div></td>
                        </tr>
                    </table>
                </div>
                <div class="form-group col-xs-3 col-md-offset-9">
                    <button type="button" class="btn btn-primary" id="submitBtn" onclick="item_add_submit()">添加</button>
                </div>
            </form>
        </div>
    </div>

</div>
</body>
</html>
<script>
    UE.Editor.prototype._bkGetActionUrl = UE.Editor.prototype.getActionUrl;
    UE.Editor.prototype.getActionUrl = function (action) {
        if (action == 'uploadimage' || action == 'uploadscrawl' || action == 'uploadimage') {
           return "http://192.168.0.170:15000/uploader/ueditor/config"
        }
         else {
           return this._bkGetActionUrl.call(this, action);
        }
    }
    UE.delEditor('editor');
    var ue = UE.getEditor('editor',{
    toolbars:[['FullScreen', 'Source', 'Undo',
    'Redo','bold','underline','italic','test','insertimage','justifyleft','justifycenter','justifyright','justifyjustify','fontsize','kityformula']],
    //focus时自动清空初始化时的内容
    //              autoClearinitialContent:true,
    //关闭字数统计
    wordCount:false,
    //关闭elementPath
    //              elementPathEnabled:false,
    enableAutoSave: false
});

ue.ready(function(){
    //阻止工具栏的点击向上冒泡
    $(this.container).click(function(e){
        e.stopPropagation()
    })
});
//$('.xx_121_content').click(function(e){
$('body').on("click",".xx_121_content",function(e){
    var $target = $(this);
    var content = $target.html();
    var currentParnet = ue.container.parentNode.parentNode;
    var currentContent = ue.getContent();
    $target.html('');
    $target.append(ue.container.parentNode);
    ue.reset();
    setTimeout(function(){
        ue.setContent(content);
    },200)
    $(currentParnet).html(currentContent);
})
$("#subjectName").combobox({
    onChange:function(n,o){
        var value = n;
        var data, json;
        if(value == 1){//数学科目
            json = '[{"id":"1","text":"单选题","selected":true},{"id":"2","text":"填空题"},{"id":"3","text":"解答题"},{"id":"13","text":"证明题"}]';
            data = $.parseJSON(json);
        }
        if(value == 2){//政治科目
            json = '[{"id":"1","text":"单选题","selected":true},{"id":"4","text":"多选题"},{"id":"5","text":"材料题"}]';
            data = $.parseJSON(json);
        }
        if(value == 3){//英语科目
            json = '[{"id":"1","text":"单选题","selected":true},{"id":"6","text":"完型"},{"id":"7","text":"阅读题"},{"id":"8","text":"7选5"},{"id":"9","text":"翻译题"},{"id":"10","text":"排序题"},{"id":"11","text":"小作文"},{"id":"12","text":"大作文"}]';
            data = $.parseJSON(json);
        }

        $("#subjectType").combobox("loadData", data);//填充题目类型
        var subjecttype = $("#subjectType").combobox('getValue');//科目
        subfn(value,subjecttype)
    }
});
$("#subjectType").combobox({
    onChange:function(n,o){
        var subjectid = $("#subjectName").combobox('getValue');//科目
        var subjecttype = n;//题目类型
        subfn(subjectid,subjecttype)
    }
});
var subfn = function(subjectid,subjecttype){

    $(".subjectForm").children("table").hide();
    if(subjectid == 1){//数学科目
        if(subjecttype == 1){//单选题
            $("#sxdxOrzzdx").show();
        }else if(subjecttype == 2){//填空题
            $("#sxtk").show();
        }else if(subjecttype == 3||subjecttype==13){//解答题
            $("#sxjd").show();
        }
    }else if(subjectid == 2){//政治科目
        if(subjecttype == 1){//单选题
            $("#sxdxOrzzdx").show();
        }else if(subjecttype == 4){//多题
            $("#zzdx").show();
        }else if(subjecttype == 5){//材料题
            $("#zzcl").show();
        }
    }else if(subjectid == 3){
        console.log(0);
        if(subjecttype == 1){//单选题
            $("#sxdxOrzzdx").show();
        }else if(subjecttype == 6){//完型题
            $("#yywx").show();
        }else if(subjecttype == 7){//阅读题
            $("#yyyd").show();
        }else if(subjecttype == 8){//7选5
            $("#yyqxw").show();
        }else if(subjecttype == 9){//翻译题
            $("#yyfy").show();
        }else if(subjecttype == 10){//排序题
            $("#yypx").show();
        }else if(subjecttype == 11 ||subjecttype == 12){//小作文题
            $("#yyzw").show();
        }
    }
}
//	$(".addOption").click(function(){
$("body").on("click",".addOption",function(){
    var this_dom = $(this).parents("tbody.opentAll")
    var opentlength = this_dom.children("tr").length-1;
    if(opentlength == 7){
        $.messager.confirm("确认", "选项超出创建范围", function (r) {});
        return;
    }
    var opentsignlist = 'ABCDEFGH';
    var opentsign = opentsignlist.substr(opentlength,1);
    var html = "<tr>"+
        "<td align='right'>"+opentsign+"：</td>"+
        "<td><div class='xx_121_content option'></div></td>"+
        "</tr>";
    this_dom.children("tr").eq(opentlength).before(html);
});

//政治材料题-添加问题
$(".addPolQuestion").click(function(){
    var this_dom = $(this).parents("tbody.opentAll")
    var opentlength = this_dom.children("tr").length-1;
    var opentsign = opentlength+1;
    var html = "<tr>"+
        "<td align='right'>（"+(opentsign)+"）：</td>"+
        "<td><div class='xx_121_content question'></div></td>"+
        "</tr>";
    this_dom.children("tr").eq(opentlength).before(html);
});
//政治材料题-添加答案
$(".addPolOption").click(function(){
    var this_dom = $(this).parents("tbody.opentAll")
    var opentlength = this_dom.children("tr").length-1;
    var opentsign = opentlength+1;
    var html = "<tr>"+
        "<td align='right'>（"+(opentsign)+"）：</td>"+
        "<td><div class='xx_121_content answer'></div></td>"+
        "</tr>";
    this_dom.children("tr").eq(opentlength).before(html);
});

$(".addAnswerGroup").click(function(){//英语完型，添加问题组

    var this_dom = $(this).parents("tbody.answerAll")
    var opentlength = (this_dom.children("tr").length);
    var html = "<tr class='yywxwt0'>"+
        "				    						<td align='right'>（"+opentlength+"）：</td>"+
        "				    						<td class='yywxwt1'>"+
        "				    							<table class='yywxwt2' border='0' cellspacing='' cellpadding='5' width='100%'>"+
        "							    					<tbody class='opentAll'>"+
        "								    					<tr>"+
        "								    						<td align='right' width='10%'>A：</td>"+
        "								    						<td><div class='xx_121_content option'></div></td>"+
        "								    					</tr>"+
        "								    					<tr>"+
        "								    						<td></td>"+
        "								    						<td>"+
        "								    							<a href='javascript:void(0)' class='btn_121_addBtn addEnglishOption'>添加选项</a>"+
        "								    						</td>"+
        "								    					</tr>"+
        "														<tr>"+
        "								    						<td align='right'>答案：</td>"+
        "								    						<td><input class='answerInput' onkeyup='this.value=this.value.toUpperCase()' maxlength='1' /></td>"+
        "								    					</tr>"+
        "							    					</tbody>"+
        "							    				</table>"+
        "				    						</td>"+
        "				    					</tr>";
    this_dom.children("tr").eq(opentlength-1).before(html);
})

$(".addReadGroup").click(function(){//英语阅读题，添加选项组

    var this_dom = $(this).parents("tbody.readAll")
    var opentlength = (this_dom.children("tr").length);
    var opentlengthStr = parseInt(((opentlength-1)/2))+1;
    var html = "<tr>"+
        "				    						<td align='right'>（"+opentlengthStr+"）：</td>"+
        "				    						<td class='yyyd_xx_outer'><div class='xx_121_content question'></div></td>"+
        "				    					</tr>"+
        "				    					<tr>"+
        "				    						<td></td>"+
        "				    						<td>"+
        "				    							<table border='0' cellspacing='' cellpadding='5' width='100%'>"+
        "							    					<tbody class='opentAll'>"+
        "								    					<tr>"+
        "								    						<td align='right' width='10%'>A：</td>"+
        "								    						<td class='yyyd_xx_inner'><div class='xx_121_content option'></div></td>"+
        "								    					</tr>"+
        "								    					<tr>"+
        "								    						<td></td>"+
        "								    						<td>"+
        "								    							<a href='javascript:void(0)' class='btn_121_addBtn addEnglishOptiony'>添加选项</a>"+
        "								    						</td>"+
        "								    					</tr>"+
        "														<tr>"+
        "								    						<td align='right'>答案：</td>"+
        "								    						<td><input class='answerInput' onkeyup='this.value=this.value.toUpperCase()' maxlength='1' /></td>"+
        "								    					</tr>"+
        "								    					<td align='right'>解析：</td>"+
        "								    						<td><div class='xx_121_content analysis'></div></td>"+
        "								    					</tr>"+
        "							    					</tbody>"+
        "							    				</table>"+
        "				    						</td>"+
        "				    					</tr>";
    this_dom.children("tr").eq(opentlength-1).before(html);
})

$(".addAnalysis").click(function(){//英语完型添加解析
    var this_dom = $(this).parents(".analysistr");
    var length = this_dom.children("tr").length;
    var html = "<tr>"+
        "<td width=\"10%\" align=\"right\">"+
        "（"+length+"）："+
        "</td>"+
        "<td>"+
        "<div style='width:700px;'class='xx_121_content analysis'></div>"+
        "</td>"+
        "</tr>";
    this_dom.children("tr").eq(length-1).before(html);
});
// 英语7选5 添加答案
$(".addAnswer").click(function(){
    var this_dom = $(this).parents(".answerAll");
    var length = this_dom.children("tr").length;
    var html = "<tr>"+
        "<td width=\"10%\" align=\"right\">"+
        "（"+length+"）："+
        "</td>"+
        "<td>"+
        "<div style='width:700px;'class='xx_121_content answer'></div>"+
        "</td>"+
        "</tr>";
    this_dom.children("tr").eq(length-1).before(html);
});
$("body").on("click",".addEnglishOption",function(){//英语完型，英语阅读里的问题添加选项
    var this_dom = $(this).parents("tbody.opentAll")
    var opentlength = this_dom.children("tr").length-1;
    if(opentlength == 7){
        $.messager.confirm("确认", "选项超出创建范围", function (r) {});
        return;
    }
    var opentsignlist = 'ABCDEFGH';
    var opentsign = opentsignlist.substr(opentlength-1,1);
    var html = "<tr>"+
        "<td align='right'>"+opentsign+"：</td>"+
        "<td><div class='xx_121_content option'></div></td>"+
        "</tr>";
    this_dom.children("tr").eq(opentlength-1).before(html);
})
;
$("body").on("click",".addEnglishOptiony",function(){//英语阅读里的问题添加选项
    console.log(1)
    var this_dom = $(this).parents("tbody.opentAll")
    var opentlength = this_dom.children("tr").length-2;
    if(opentlength == 7){
        $.messager.confirm("确认", "选项超出创建范围", function (r) {});
        return;
    }
    var opentsignlist = 'ABCDEFGH';
    var opentsign = opentsignlist.substr(opentlength-1,1);
    var html = "<tr>"+
        "<td align=\"right\">"+opentsign+"：</td>"+
        "<td><div class=\"xx_121_content option\"></div></td>"+
        "</tr>";
    this_dom.children("tr").eq(opentlength-1).before(html);
});
</script>
<script>
    function item_add_submit() {
        var currentParnet = ue.container.parentNode.parentNode;
        var currentContent = ue.getContent();
        ue.reset();
        $(currentParnet).html(currentContent);
        // var sub = $("#subjectName").find("option:selected").val();
        var sub = $("#subjectName").combobox('getValue');
        var item_from = $('#subjectForm').val();
        var year = $('#year').find("option:selected").text();
        var stars = $('#stars').val();
        //题型
        // var item_type=$("#subjectType").find("option:selected").val();
        var item_type = $("#subjectType").combobox('getValue');
        //启用类型
        //var type = $("#statu").find("option:selected").val();
        var type = $("#statu").val();
        var content = $("table:first tr:last td:last").children("div").html();
        content = encodeURIComponent(content);
        var param = '{';
        //单选的时候,对应数据库answers,选项
        if (sub == 1 && item_type == 1) {
            var answers = '';
            var page_answers = $("#sxdxcontents").find("tr td div");
            for (var i = 0; i < page_answers.length; i++) {
                answers += page_answers.eq(i).html() + ",";
            }
            answers = answers.substring(0, answers.length - 1);
            answers = encodeURIComponent(answers);

            var right_answers = $("#sxanswer").val();
            right_answers = encodeURIComponent(right_answers);

            var analysis = $(".sxdxjx div").html();
            analysis = encodeURIComponent(analysis);
            var param = '{';
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","answers":"' + answers + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);
        }
        //填空题
        if (sub == 1 && item_type == 2) {

            var answers = '';
            var page_answers = $("#sxtk").find("tr td div");

            answers += page_answers.eq(0).html();
            answers = answers.substring(0, answers.length);
            answers = encodeURIComponent(answers);
            var analysis = page_answers.eq(1).html() + ",";
            analysis = encodeURIComponent(analysis);
            var param = '{';
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","answers":"' + answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);

        }
        //解答(3)，证明(13)
        if (sub == 1 && (item_type == 3 || item_type == 13)) {

            var page_answers = $("#sxjd").find("tr td div");
            var analysis = page_answers.eq(0).html() + ",";
            analysis = encodeURIComponent(analysis);
            var param = '{';
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);

        }
        //政治,单选
        if (sub == 2 && item_type == 1) {
            var answers = '';
            var page_answers = $("#sxdxcontents").find("tr td div");
            for (var i = 0; i < page_answers.length; i++) {
                answers += page_answers.eq(i).html() + ",";
            }
            answers = answers.substring(0, answers.length - 1);
            answers = encodeURIComponent(answers);
            var right_answers = $("#sxanswer").val();
            right_answers = encodeURIComponent(right_answers);
            var analysis = $(".sxdxjx div").html();
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","answers":"' + answers + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);
        }
        //政治，多选
        if (sub == 2 && item_type == 4) {
            var answers = '';
            var page_answers = $("#zzdxcontents").find("tr td div");
            for (var i = 0; i < page_answers.length; i++) {
                answers += page_answers.eq(i).html() + ",";
            }
            answers = answers.substring(0, answers.length - 1);
            console.log("!!!!"+answers)
            answers = encodeURIComponent(answers);

            var right_answers = $("#zzdxanswer").val();
            console.log("!!!!"+right_answers)
            right_answers = encodeURIComponent(right_answers);

            var analysis = $(".zzany div").html()
            console.log("!!!!"+analysis)
            analysis = encodeURIComponent(analysis);
            console.log("!!!!"+analysis)
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","answers":"' + answers + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);

        }
        //政治，材料
        if (sub == 2 && item_type != 1 && item_type != 4) {
            var questions = '';
            var page_questions = $("#zzclxx").find("tr td div");
            for (var i = 0; i < page_questions.length; i++) {
                questions += page_questions.eq(i).html() + ",";
            }
            questions = questions.substring(0, questions.length - 1);
            questions = encodeURIComponent(questions);
            var right_answers = '';
            var page_answers = $("#zzcldn").find("tr td div");
            for (var j = 0; j < page_answers.length; j++) {
                right_answers += page_answers.eq(j).html() + ",";
            }
            right_answers = right_answers.substring(0, right_answers.length - 1);
            right_answers = encodeURIComponent(right_answers);
            var analysis = $("#zzcl .zzany div").html();
            console.log("!!!!"+analysis);
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","questions":"' + questions + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            console.log(param);
            param = encodeURIComponent(param);
        }
        //英语单选
        if (sub == 3 && item_type == 1) {
            var answers = '';
            var page_answers = $("#sxdxcontents").find("tr td div");
            for (var i = 0; i < page_answers.length; i++) {
                answers += page_answers.eq(i).html() + ",";
            }
            answers = answers.substring(0, answers.length - 1);
            answers = encodeURIComponent(answers);


            var right_answers = $("#sxanswer").val();
            right_answers = encodeURIComponent(right_answers);

            var analysis = $(".sxdxjx div").html();
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","answers":"' + answers + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);
        }
        //英语，完形
        if (sub == 3 && item_type == 6) {
            var questions = '';
            //多少个问题=page_questions.length
            var page_questions_big = $("#yywxwt0").find("tr.yywxwt0");
            var right_answers = '';
            var analysis = "";
            for (var i = 0; i < page_questions_big.length; i++) {
                var page_questions_inner = page_questions_big.eq(i).find("td.yywxwt1 .yywxwt2 tr td div");
                var arg_inner = "";
                var right_answer = page_questions_big.eq(i).find("td.yywxwt1 .yywxwt2 input.answerInput").val();
                for (var j = 0; j < page_questions_inner.length; j++) {
                    var temp = page_questions_inner.eq(j).html();
                    if (j != page_questions_inner.length - 1) {
                        arg_inner += temp + "@@@";
                    }
                    else {
                        arg_inner += temp;
                    }
                }

                if (i != page_questions_big.length - 1) {
                    questions += arg_inner + "###";
                    right_answers += right_answer + ",";
                }
                else {
                    questions += arg_inner;
                    right_answers += right_answer;

                }

            }
            questions = encodeURIComponent(questions);
            console.log(right_answers);
            right_answers = encodeURIComponent(right_answers);

            var page_analysis = $(".yywxjx .analysis");
            for (var i = 0; i < page_analysis.length; i++) {
                var inp_html = page_analysis.eq(i).html();
                if (i != page_analysis.length - 1) {
                    analysis += inp_html + ",";
                }
                else {
                    analysis += inp_html;
                }
            }
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","questions":"' + questions + '","correctanswers":"'
                + right_answers + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);
        }
        //英语阅读
        if (sub == 3 && item_type == 7) {
            var answers = '';
            var questions = '';
            //多少个问题=page_questions.length
            var page_questions = $(".yyyd_out .yyyd_xx_outer .question");

            //    console.log($(".yyyd_out tr:first").html());
            console.log($(".yyyd_out tr").html());

            for (var i = 0; i < page_questions.length; i++) {
                //大问题
                var qustion_out = page_questions.eq(i).html();
                var qustion_inner = $(".yyyd_xx_inner div");

                //小问题
                var question = "";
                for (var j = 0; j < qustion_inner.length; j++) {
                    var per_qustion = qustion_inner.eq(j).html();
                    if (j != qustion_inner.length - 1) {
                        question += per_qustion + "@@@";
                    }
                    else {
                        question += per_qustion;
                    }
                }

                if (i != page_questions.length - 1) {
                    questions += qustion_out + "###" + question + "###";
                }
                else {
                    questions += qustion_out + "###" + question;

                }
            }

            // console.log(questions);

            /*    var page_answers=$("#yyyd ").find("tr td div");
                for(var i=0;i<page_answers.length;i++){
                    answers+=page_answers.eq(i).html()+",";
                }
                answers=answers.substring(0,answers.length-1);
                answers=encodeURIComponent(answers);

                var right_answers=$("#sxanswer").val();
                right_answers =encodeURIComponent(right_answers);

                var analysis=$(".sxdxjx div").html();
                analysis =encodeURIComponent(analysis);
                var param='{';
                param+='"subject":"'+sub+'","itemtype":"'+item_type+'","titlefrom":"'+item_from+'","content":"'+content+'","type":"'
                    +type+'","year":"'+year+'","stars":"'+stars+'","answers":"'+answers+'","correctanswers":"'
                    +right_answers+'","anaylses":"'+analysis+'"}';
                param =encodeURIComponent(param);*/
        }
        //7选5
        if (sub == 3 && item_type == 8) {
            var questions = "";
            var page_questions = $("#yy_7_xx tr td div");
            for (var i = 0; i < page_questions.length; i++) {
                if (i != page_questions.length - 1) {
                    questions += page_questions.eq(i).html() + ",";
                }
                else {
                    questions += page_questions.eq(i).html();

                }
            }
            questions = encodeURIComponent(questions);
            var analysis = "";
            var page_anaylses = $("#yy_7_jx tr td div");
            for (var i = 0; i < page_anaylses.length; i++) {
                if (i != page_questions.length - 1) {
                    analysis += page_anaylses.eq(i).html() + ",";
                }
                else {
                    analysis += page_anaylses.eq(i).html();

                }
            }
            analysis = encodeURIComponent(analysis);
            var param = '{';
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","questions":"' + questions + '","anaylses":"' + analysis + '"}';
            console.log(param);
            param = encodeURIComponent(param);
        }
        //英语翻译
        if (sub == 3 && item_type == 9) {

            var questions = "";
            var page_questions= $("#yyfy_xx").find("tr td div");
            //var page_questions = $("#yyfy_xx tr td div");
            for (var i = 0; i < page_questions.length; i++) {
                if (i != page_questions.length - 1) {
                    questions += page_questions.eq(i).html() + ",";
                }
                else {
                    questions += page_questions.eq(i).html();

                }
            }
            questions = encodeURIComponent(questions);
            var analysis = "";
            var page_anaylses =$("#yyfy_jx").find("tr td div");
            for (var i = 0; i < page_anaylses.length; i++) {
                if (i != page_questions.length - 1) {
                    analysis += page_anaylses.eq(i).html() + ",";
                }
                else {
                    analysis += page_anaylses.eq(i).html();

                }
            }
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","questions":"' + questions + '","anaylses":"' + analysis + '"}';
            console.log(param);
            param = encodeURIComponent(param);

        }
        //英语排序
        if (sub == 3 && item_type == 10) {
            var questions = "";
            var page_questions = $("#yypx_xx tr td div");
            for (var i = 0; i < page_questions.length; i++) {
                if (i != page_questions.length - 1) {
                    questions += page_questions.eq(i).html() + ",";
                }
                else {
                    questions += page_questions.eq(i).html();

                }
            }
            questions = encodeURIComponent(questions);
            var analysis = "";
            var page_anaylses = $("#yypx_jx tr td div");
            for (var i = 0; i < page_anaylses.length; i++) {
                if (i != page_questions.length - 1) {
                    analysis += page_anaylses.eq(i).html() + ",";
                }
                else {
                    analysis += page_anaylses.eq(i).html();

                }
            }
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","questions":"' + questions + '","anaylses":"' + analysis + '"}';
            console.log(param);
            param = encodeURIComponent(param);

        }
        //英语作文
        if (sub == 3 && (item_type == 11 || item_type == 12)) {
            var analysis = $('#yyzw tr td div').eq(0).html();
            analysis = encodeURIComponent(analysis);
            param += '"subject":"' + sub + '","itemtype":"' + item_type + '","titlefrom":"' + item_from + '","content":"' + content + '","type":"'
                + type + '","year":"' + year + '","stars":"' + stars + '","anaylses":"' + analysis + '"}';
            param = encodeURIComponent(param);
        }
        /* var lores = "";
         var lores_check = $("#item_add_lore").datagrid("getChecked");
         for (var i = 0; i < lores_check.length; i++) {
             if (i != lores_check.length - 1) {
                 lores += lores_check[i].id + ",";
             }
             else {
                 lores += lores_check[i].id;
             }
         }*/
       $.ajax({
            url: "http://192.168.0.170:15000/yc-crm/item/add?param='" + param + "'",
            type: "post",
            dataType: "json",
            success: function (msg) {
                if (msg.status == 0) {
                    alert("加入习题库成功");
                }
            }
        })
    }
</script>