<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用户管理</title>
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.min.css">
    <link href="../../css/bootstrap-theme.css" rel="stylesheet">
    <link href="../../bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="bootstraptable/bootstrap-table.css">
    <script src="../../js/jquery.js"></script>
    <script src="../../js/public.js"></script>
    <script src="../../js/bootstrap.js"></script>
    <script src="../../bootstraptable/bootstrap-table.js"></script>
    <script src="../../bootstraptable/bootstrap-table-zh-CN.js"></script>
</head>
<body>
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">当前位置>用户管理>学生用户计划></h3>
    </div>
    <div class="panel-body">
        <br>
        <table class="table" id="table">
        </table>
    </div>
    <br>
</div>
</body>
</html>
<script>
    var id = GetQueryString("id");
    function search_user_plan() {
        $('#table').bootstrapTable({
            method: 'get',
            striped: true,
            cache: false,
            pagination: true,
            sortable: false,
            sortOrder: "asc ",
            pageSize: 10,
            pageList: [10, 20, 50],
            url: 'http://192.168.0.170:15000/yc-crm/user/plan/search',
            queryParams: setParams,
            sidePagination: "server",
            search: false,
            strictSearch: false,
            idField: "id ",
            columns: [
                {
                    width: 20,
                    field: 'number',
                    title: '轮次',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?"第"+value+"轮":"暂无数据";
                    }
                },
                {
                    width: 20,
                    field: 'number',
                    title: '复习时间',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?"第"+value+"轮":"暂无数据";
                    }
                },
                {
                    width: 20,
                    field: 'target_start_time',
                    title: '计划开始时间',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }
                },
                {
                    width: 20,
                    field: 'target_end_time',
                    title: '计划结束时间',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }
                },
                {
                    width: 20,
                    field: 'plan_real_endtime',
                    title: '计划实际结束时间',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }
                },
                {
                    width: 20,
                    field: '',
                    title: '本科目本轮星星数',
                    align: 'center',
                    formatter:function(value, row, index) {
                        if(row){
                            var count=0;
                            if(row.t_star){
                                var t_star=row.t_star.split(" ");
                                for(var i=0;i<t_star.length;i++){
                                    count+=parseInt(t_star[i]);
                                }
                            }
                            if(row.p_star){
                                var p_star=row.p_star.split(" ");
                                for(var i=0;i<p_star.length;i++){
                                    count+=parseInt(p_star[i]);
                                }
                            }
                            if(row.w_star){
                                var w_star=row.w_star.split(" ");
                                for(var i=0;i<w_star.length;i++){
                                    count+=parseInt(w_star[i]);
                                }
                            }
                            if(row.i_star){
                                var i_star=row.i_star.split(" ");
                                for(var i=0;i<i_star.length;i++){
                                    count+=parseInt(i_star[i]);
                                }
                            }

                            return count
                        }
                        else{
                            return "暂无数据"
                        }
                    }
                },
                {
                    width: 20,
                    field: 'user_star',
                    title: '用户获取星星数',
                    align: 'center',   align: 'center',
                    formatter:function(value, row, index) {
                        if(row) {
                            var count = 0;
                            if (row.t_userstar) {
                                var t_userstar = row.t_userstar.split(" ");
                                for (var i = 0; i < t_userstar.length; i++) {
                                    count += parseInt(t_userstar[i]);
                                }
                            }
                            if (row.p_userstar) {
                                var p_userstar = row.p_userstar.split(" ");
                                for (var i = 0; i < p_userstar.length; i++) {
                                    count += parseInt(p_userstar[i]);
                                }
                            }
                            if (row.w_userstar) {
                                var w_userstar = row.w_userstar.split(" ");
                                for (var i = 0; i < w_userstar.length; i++) {
                                    count += parseInt(w_userstar[i]);
                                }
                            }
                            if (row.i_userstar) {
                                var i_userstar = row.i_userstar.split(" ");
                                for (var i = 0; i < i_userstar.length; i++) {
                                    count += parseInt(i_userstar[i]);
                                }
                            }
                            return count
                        }
                        else{
                            return "暂无数据"
                        }
                    }
                },
            ],
            pagination: true
        });
        $('#table_info').bootstrapTable('refresh');
    }
    function initParams(arg) {
        var param = {};
        param.user_id=id;
        param.plat="0"
        arg.param=JSON.stringify(param);
        return arg;
    }
    function setParams(arg) {

        var param = {};
        param.id=id;


        var plan_start_begin = $('#plan_start_begin').val();
        if (plan_start_begin) {
            param.plan_start_begin=plan_start_begin;
        }
        var plan_start_end = $('#plan_start_end').val();
        if (plan_start_end) {
            param.plan_start_end=plan_start_end;
        }
        param.plat="0";
        arg.param=JSON.stringify(param);
        return arg;
    }
    $('#table').bootstrapTable({
        method: 'get',
        striped: true,
        cache: false,
        pagination: true,
        sortable: false,
        sortOrder: "asc ",
        pageSize: 10,
        pageList: [10, 20, 50],
        url: 'http://192.168.0.170:15000/yc-crm/user/plan/search',
        queryParams: initParams,
        sidePagination: "server",
        search: false,
        strictSearch: false,
        idField: "id",
        columns: [
            {
                width: 20,
                field: '',
                title: '复习内容',
                align: 'center',
                formatter:function(value, row, index) {
                    if(row){
                        var count='';
                        if(row.t_names){
                            var t_names=row.t_names.split(" ");
                            for(var i=0;i<t_names.length;i++){
                                count+='《'+t_names[i]+'教材》';
                            }
                        }
                        if(row.p_names){
                            var p_names=row.p_names.split(" ");
                            for(var i=0;i<p_names.length;i++){
                                count+='《'+p_names[i]+'试卷 》';
                            }
                        }
                        return count
                    }
                    else{
                        return "暂无数据"
                    }
                }
            },
            {
                width: 20,
                field: 'number',
                title: '轮次',
                align: 'center',
                formatter:function(value) {
                    return  value!=null?"第"+value+"轮":"暂无数据";
                }
            },
            {
                width: 20,
                field: 'atdate',
                title: '复习时间',
                align: 'center',

            },
            {
                width: 20,
                field: 'target_start_time',
                title: '计划开始时间',
                align: 'center',
                formatter:function(value) {
                    return  value!=null?value:"暂无数据"
                }
            },
            {
                width: 20,
                field: 'target_end_time',
                title: '计划结束时间',
                align: 'center',
                formatter:function(value) {
                    return  value!=null?value:"暂无数据"
                }
            },
            {
                width: 20,
                field: 'plan_real_endtime',
                title: '计划实际结束时间',
                align: 'center',
                formatter:function(value) {
                    return  value!=null?value:"暂无数据"
                }
            },
            {
                width: 20,
                field: '',
                title: '本科目本轮星星数',
                align: 'center',
                formatter:function(value, row, index) {
                    if(row){
                        var count=0;
                        if(row.t_star){
                            var t_star=row.t_star.split(" ");
                            for(var i=0;i<t_star.length;i++){
                                count+=parseInt(t_star[i]);
                            }
                        }
                        if(row.p_star){
                            var p_star=row.p_star.split(" ");
                            for(var i=0;i<p_star.length;i++){
                                count+=parseInt(p_star[i]);
                            }
                        }
                        if(row.w_star){
                            var w_star=row.w_star.split(" ");
                            for(var i=0;i<w_star.length;i++){
                                count+=parseInt(w_star[i]);
                            }
                        }
                        if(row.i_star){
                            var i_star=row.i_star.split(" ");
                            for(var i=0;i<i_star.length;i++){
                                count+=parseInt(i_star[i]);
                            }
                        }

                        return count
                    }
                    else{
                        return "暂无数据"
                    }
                }
            },
            {
                width: 20,
                field: 'user_star',
                title: '用户获取星星数',
                align: 'center',   align: 'center',
                formatter:function(value, row, index) {
                    if(row) {
                        var count = 0;
                        if (row.t_userstar) {
                            var t_userstar = row.t_userstar.split(" ");
                            for (var i = 0; i < t_userstar.length; i++) {
                                count += parseInt(t_userstar[i]);
                            }
                        }
                        if (row.p_userstar) {
                            var p_userstar = row.p_userstar.split(" ");
                            for (var i = 0; i < p_userstar.length; i++) {
                                count += parseInt(p_userstar[i]);
                            }
                        }
                        if (row.w_userstar) {
                            var w_userstar = row.w_userstar.split(" ");
                            for (var i = 0; i < w_userstar.length; i++) {
                                count += parseInt(w_userstar[i]);
                            }
                        }
                        if (row.i_userstar) {
                            var i_userstar = row.i_userstar.split(" ");
                            for (var i = 0; i < i_userstar.length; i++) {
                                count += parseInt(i_userstar[i]);
                            }
                        }
                        return count
                    }
                    else{
                        return "暂无数据"
                    }
                }
            },
        ],    });

</script>