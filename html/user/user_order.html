<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>学生用户订单列表</title>
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.css">
    <link href="../../css/bootstrap-theme.css" rel="stylesheet">
    <link href="../../bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href../../bootstraptable/bootstrap-table.css">
    <script src="../../js/jquery.js"></script>
    <script src="../../js/public.js"></script>
    <script src="../../js/bootstrap.js"></script>
    <script src="../../bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.js" ></script>
    <script src="../../bootstrap-datetimepicker-master/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script src="../../bootstraptable/bootstrap-table.js"></script>
    <script src="../../bootstraptable/bootstrap-table-zh-CN.js"></script>
</head>
<body>
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">当前位置>消费订单管理>学生用户订单列表></h3>
    </div>
    <div class="panel-body">
        <div class="row search_Div">
            <form class="form-inline">
                <div class="form-group col-xs-2">
                    <label>用户姓名：</label>
                    <input type="text" id="user_name" class="form-control">
                </div>
                <div class="form-group col-xs-2">
                    <label>订单编号：</label>
                    <input type="text" id="order_no" class="form-control"></input>
                </div>
                <div class="form-group col-xs-2">
                    <label>订单状态：</label>
                    <select type="text" id="order_type" class="form-control">
                        <option value="-1">全部</option>
                        <option value="0">完成</option>
                        <option value="1">未完成</option>
                    </select>
                </div>
                <div class="form-group col-xs-2">
                    <label>下单时间：</label>
                    <input id="btime" type="text" class="form-control datetime">
                </div>
                <div class="form-group col-xs-2">
                    <label>至：</label>
                    <input id="etime" type="text" class="form-control datetime">
                </div>

                <div class="form-group col-xs-2">
                    <div class="form-group col-xs-2 col-md-offset-4" style="padding: 10px 0;">
                        <button type="button" class="btn btn-primary" id="submitBtn" onclick="search_user_order()">查询</button>
                    </div>
                </div>

            </form>
        </div>
        <br><br>
        <table class="table" id="table">
        </table>
    </div>
</div>
</body>
</html>
<script>

    $('.datetime').datetimepicker({
        language:  'zh-CN',
        format: 'yyyy-mm-dd',
        minView: "month", //选择日期后，不会再跳转去选择时分秒
        autoclose:true //选择日期后自动关闭
    });
    function search_user_order() {
        $('#table').bootstrapTable({
            method: 'get',
            striped: true,
            cache: false,
            pagination: true,
            sortable: false,
            sortOrder: "asc ",
            pageSize: 10,
            pageList: [10, 20, 50],
            url: 'http://192.168.0.170:15000/yc-crm/order/search',
            queryParams: setParams,
            sidePagination: "server",
            search: false,
            strictSearch: false,
            idField: "id ",
            columns: [
                {
                    width: 20,
                    field: 'name',
                    title: '用户名',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }

                },
                {
                    width: 20,
                    field: 'order_no',
                    title: '订单编号',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }
                },
                {
                    width: 20,
                    field: 'create_time',
                    title: '下单时间',
                    align: 'center',
                    formatter: function (value) {
                        return  value!=null?value:"暂无数据"
                    }
                },
                {
                    width: 20,
                    field: 'sum_money',
                    title: '消费金额',
                    align: 'center'
                },
                {
                    width: 20,
                    field: 'real_money',
                    title: '实际金额',
                    align: 'center'
                },
                {
                    width: 20,
                    field: 'pay_type',
                    title: '支付方式',
                    align: 'center',
                    formatter:function(value) {
                        return  value!=null?value:"暂无数据"
                    }
                 },
                {
                    width: 50,
                    field: '',
                    title: '基本操作',
                    align: 'center',
                    formatter: function (value, row, index) {
                        var info ='<a onclick="jump_to_per_user_order('+row.id+')">详情&nbsp;</a>';
                        return info ;
                    }
                }
            ],
            pagination: true
        })
        $('#table').bootstrapTable('refresh');
    }
    function setParams(arg) {

        var param = {};
        var user_name = $('#user_name').val();
        if (user_name) {
            param.name=user_name;
        }
        var order_no = $('#order_no').val();
        if (order_no) {
            param.orderno=order_no;
        }
        var order_type = $('#order_type').val();
        if (order_type) {
            param.orderstatus=order_type;
        }

        var btime = $('#btime').val();
        if (btime) {
            param.bcreatetime=btime;
        }
        var etime = $('#etime').val();
        if (etime) {
            param.ecreatetime=etime;
        }
        param.usertype="0";
        param.plat="0";
        arg.param=JSON.stringify(param);
        return arg;
    }
    function jump_to_per_user_order(id){
        window.location.href = "user_order_info.html?id='"+id+"'";
    }
</script>